{"ast":null,"code":"import React from 'react';\nimport jwt from 'jwt-decode';\nconst TokenProvider = {\n  setTokens: function (access_token, refresh_token) {\n    localStorage.setItem(\"ACCESS_TOKEN\", access_token);\n    localStorage.setItem(\"REFRESH_TOKEN\", refresh_token);\n  },\n  getAccessToken: function () {\n    return localStorage.getItem(\"ACCESS_TOKEN\");\n  },\n  getRefreshToken: function () {\n    return localStorage.getItem(\"REFRESH_TOKEN\");\n  },\n  getExpirationDate: function (jwtToken) {\n    if (jwtToken === null || jwtToken === 'null') {\n      return null;\n    }\n\n    if (!jwtToken) {\n      return null;\n    }\n\n    const jwt = JSON.parse(atob(jwtToken.split('.')[1])); // multiply by 1000 to convert seconds into milliseconds\n\n    return jwt && jwt.exp && jwt.exp * 1000;\n  },\n  isExpired: function (expirationDate) {\n    if (expirationDate === null || expirationDate === 'null') {\n      return true;\n    }\n\n    return Date.now() > expirationDate;\n    /* Returns true if the expiration is invalid/expired */\n  },\n  getToken: async function () {\n    if (!localStorage.getItem(\"ACCESS_TOKEN\")) {\n      return null;\n    }\n\n    if (isExpired(getExpirationDate(localStorage.getItem(\"ACCESS_TOKEN\")))) {\n      /*\r\n      const updatedToken = await fetch('/update-token', {\r\n          method: 'POST',\r\n          // send refresh token\r\n          // method to update token \r\n      })\r\n          .then(r => r.json());\r\n      */\n      // setTokens(updatedToken, updatedRefreshToken);\n    }\n\n    return localStorage.getItem(\"ACCESS_TOKEN\");\n  },\n  getEmail: function () {\n    let token = getAccessToken();\n    let decoded = jwt(token);\n    return decoded.sub;\n  },\n  isLoggedIn: function () {\n    // if (localStorage.getItem(\"ACCESS_TOKEN\")) return false;\n    if (isExpired(getExpirationDate(localStorage.getItem(\"ACCESS_TOKEN\")))) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n};\nexport default TokenProvider;\n/** EXPORT FUNCTIONS */\n\n/** defined functions that are used in above functions */\n\nfunction getExpirationDate(jwtToken) {\n  if (jwtToken === null || jwtToken === 'null') {\n    return null;\n  }\n\n  const jwt = JSON.parse(atob(jwtToken.split('.')[1])); // multiply by 1000 to convert seconds into milliseconds\n\n  return jwt && jwt.exp && jwt.exp * 1000;\n}\n\nfunction isExpired(expirationDate) {\n  if (expirationDate === null || expirationDate === 'null') {\n    return true;\n  }\n\n  if (!expirationDate) {\n    return true;\n  }\n\n  return Date.now() > expirationDate;\n  /* Returns true if the expiration is invalid/expired */\n}","map":{"version":3,"sources":["D:/gitHub_projects/Stock/src/main/ui/src/components/TokenProvider.js"],"names":["React","jwt","TokenProvider","setTokens","access_token","refresh_token","localStorage","setItem","getAccessToken","getItem","getRefreshToken","getExpirationDate","jwtToken","JSON","parse","atob","split","exp","isExpired","expirationDate","Date","now","getToken","getEmail","token","decoded","sub","isLoggedIn"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport jwt from 'jwt-decode';\r\n\r\nconst TokenProvider = {\r\n    setTokens: function(access_token, refresh_token) {\r\n        localStorage.setItem(\"ACCESS_TOKEN\", access_token);\r\n        localStorage.setItem(\"REFRESH_TOKEN\", refresh_token);\r\n    },\r\n\r\n    getAccessToken: function() {\r\n        return localStorage.getItem(\"ACCESS_TOKEN\");\r\n    },\r\n\r\n    getRefreshToken: function() {\r\n        return localStorage.getItem(\"REFRESH_TOKEN\");\r\n    },\r\n\r\n    getExpirationDate: function(jwtToken) {\r\n        if (jwtToken === null || jwtToken === 'null') {\r\n            return null;\r\n        }\r\n        if (!jwtToken) {\r\n            return null;\r\n        }\r\n    \r\n        const jwt = JSON.parse(atob(jwtToken.split('.')[1]));\r\n    \r\n        // multiply by 1000 to convert seconds into milliseconds\r\n        return jwt && jwt.exp && jwt.exp * 1000;\r\n    },\r\n\r\n    \r\n    isExpired: function(expirationDate) {\r\n        if (expirationDate === null || expirationDate === 'null') {\r\n            return true;\r\n        }\r\n\r\n        return Date.now() > expirationDate; /* Returns true if the expiration is invalid/expired */\r\n    },\r\n\r\n    getToken: async function() {\r\n        if (!localStorage.getItem(\"ACCESS_TOKEN\")) {\r\n            return null;\r\n        }\r\n        \r\n        if (isExpired(getExpirationDate(localStorage.getItem(\"ACCESS_TOKEN\")))) {\r\n            /*\r\n            const updatedToken = await fetch('/update-token', {\r\n                method: 'POST',\r\n                // send refresh token\r\n                // method to update token \r\n            })\r\n                .then(r => r.json());\r\n            */\r\n\r\n            // setTokens(updatedToken, updatedRefreshToken);\r\n        }\r\n\r\n        return localStorage.getItem(\"ACCESS_TOKEN\");\r\n    },\r\n\r\n    getEmail: function() {\r\n        let token = getAccessToken();\r\n        let decoded = jwt(token);\r\n        return decoded.sub;\r\n    },\r\n\r\n    isLoggedIn: function() { \r\n        // if (localStorage.getItem(\"ACCESS_TOKEN\")) return false;\r\n        if ((isExpired(getExpirationDate(localStorage.getItem(\"ACCESS_TOKEN\"))))) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default TokenProvider; /** EXPORT FUNCTIONS */\r\n\r\n\r\n\r\n\r\n/** defined functions that are used in above functions */\r\nfunction getExpirationDate(jwtToken) {\r\n    if (jwtToken === null || jwtToken === 'null') {\r\n        return null;\r\n    }\r\n\r\n    const jwt = JSON.parse(atob(jwtToken.split('.')[1]));\r\n\r\n    // multiply by 1000 to convert seconds into milliseconds\r\n    return jwt && jwt.exp && jwt.exp * 1000;\r\n}\r\n\r\n\r\nfunction isExpired (expirationDate) {\r\n    if (expirationDate === null || expirationDate === 'null') {\r\n        return true;\r\n    }\r\n    if (!expirationDate) {\r\n        return true;\r\n    }\r\n\r\n    return Date.now() > expirationDate; /* Returns true if the expiration is invalid/expired */\r\n}"]},"metadata":{},"sourceType":"module"}